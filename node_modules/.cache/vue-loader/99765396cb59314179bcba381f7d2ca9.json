{"remainingRequest":"/Users/xurunjie/Documents/flutter/ws/shuyupingmin/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/xurunjie/Documents/flutter/ws/shuyupingmin/src/views/user/index.vue?vue&type=style&index=0&id=4498f7b0&scoped=true&lang=css&","dependencies":[{"path":"/Users/xurunjie/Documents/flutter/ws/shuyupingmin/src/views/user/index.vue","mtime":1716171993894},{"path":"/Users/xurunjie/Documents/flutter/ws/shuyupingmin/node_modules/css-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/xurunjie/Documents/flutter/ws/shuyupingmin/node_modules/vue-loader/lib/loaders/stylePostLoader.js","mtime":499162500000},{"path":"/Users/xurunjie/Documents/flutter/ws/shuyupingmin/node_modules/postcss-loader/src/index.js","mtime":499162500000},{"path":"/Users/xurunjie/Documents/flutter/ws/shuyupingmin/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/xurunjie/Documents/flutter/ws/shuyupingmin/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:CgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCi5leHBvcnQtZXhjZWwtd3JhcHBlcnsKICBtYXJnaW4tYm90dG9tOiAxMHB4Owp9Cg=="},{"version":3,"sources":["index.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAyNA;AACA;AACA","file":"index.vue","sourceRoot":"src/views/user","sourcesContent":["<template>\n  <div class=\"app-container\">\n    <commonForm :inline=\"true\" :data=\"getInfoData\" :formConfig=\"formConfig\">\n    </commonForm>\n    <JsonExcel\n     v-if=\"total > 0\"\n      class = \"export-excel-wrapper\"\n      :data = \"downloaddata\"\n      :fields = \"json_fields\"\n      name = \"销售退货.xls\">\n      <!-- 上面可以自定义自己的样式，还可以引用其他组件button -->\n      <el-button type=\"primary\" size=\"small\">导出EXCEL</el-button>\n    </JsonExcel>\n    <!-- <el-upload action=\"\" :auto-upload=\"false\" :on-change=\"upload\" :limit=\"1\">\n      <el-button size=\"mini\" type=\"success\">上传文件</el-button>\n    </el-upload> -->\n    <el-table\n      :data=\"tabData\"\n      element-loading-text=\"Loading\"\n      border\n      fit\n      highlight-current-row\n      class=\"forms\"\n    >\n      <el-table-column\n        prop=\"往来帐日期\"\n        width=\"120\"\n        label=\"往来帐日期\"\n      ></el-table-column>\n      <el-table-column\n        prop=\"客户名称\"\n        min-width=\"120\"\n        label=\"客户名称\"\n      ></el-table-column>\n      <el-table-column\n        prop=\"商品编码\"\n        width=\"120\"\n        label=\"商品编码\"\n      ></el-table-column>\n      <el-table-column\n        min-width=\"130\"\n        prop=\"商品名称\"\n        label=\"商品名称\"\n      >\n      </el-table-column>\n      <el-table-column\n        prop=\"商品规格\"\n        width=\"120\"\n        label=\"商品规格\"\n      ></el-table-column>\n      <el-table-column prop=\"商品单位\" min-width=\"130\" label=\"商品单位\"></el-table-column>\n      <el-table-column label=\"生产企业名称\" min-width=\"130\" prop=\"生产企业名称\"></el-table-column>\n      <el-table-column label=\"商品批号\" width=\"120\" prop=\"商品批号\">\n      </el-table-column>\n      <el-table-column label=\"数量\" width=\"120\" prop=\"数量\">\n       \n      </el-table-column>\n      <el-table-column label=\"业务机构群\" prop=\"业务机构群\"></el-table-column> \n       \n    </el-table>\n    <!--分页器-->\n    <pagination\n      v-show=\"total > 0\"\n      :total=\"total\"\n      :page.sync=\"getInfoData.offset\"\n      :limit.sync=\"getInfoData.limit\"\n      @pagination=\"gitList\"\n    />\n  </div>\n</template>\n\n<script>\n  import * as XLSX from 'xlsx/xlsx.mjs'\n  import commonForm from \"@/components/CommonForm\";\n  import { saveAs } from 'file-saver';\n  import pagination from \"@/components/Pagination\";\n  import JsonExcel from 'vue-json-excel'\n  export default {\n    components:{\n      commonForm,\n      pagination,\n      JsonExcel\n    },\n    data() {\n      return {\n        json_fields: {\n          \"往来帐日期\": \"往来帐日期\",    //常规字段\n          \"客户名称\": \"客户名称\", //支持嵌套属性\n          \"商品编码\": \"商品编码\",    //常规字段\n          \"商品名称\": \"商品名称\",    //常规字段\n          \"商品规格\": \"商品规格\",    //常规字段\n          \"商品单位\": \"商品单位\",    //常规字段\n          \"生产企业名称\": \"生产企业名称\",    //常规字段\n          \"商品批号\": \"商品批号\",    //常规字段\n          \"数量\": \"数量\",    //常规字段\n          \"业务机构群\": \"业务机构群\",    //常规字段\n        },\n        tabData:[],\n        alldata:[],\n        downloaddata:[],\n        total:0,\n        getInfoData: {\n          limit: 10,\n          offset: 1,\n          startDelTime: [],\n          startStartTime:'',\n          endStartTime:'',\n        },\n        formConfig: {\n          formItemList: [\n            \n            {\n              label: \"\",\n              value: \"startDelTime\",\n              clearable: true,\n              startPlaceholder: \"开始日期\",\n              endPlaceholder: \"结束日期\",\n              type: \"daterange\",\n              dateFormate: \"yyyy-MM-dd\",\n            }\n          ],\n          operate: [\n            {\n              name: \"搜索\",\n              value: \"primary\",\n              type: \"button\",\n              handleClick: this.gitList,\n              authBtn: true,\n            },\n            {\n              name: \"清空搜索条件\",\n              value: \"\",\n              type: \"button\",\n              handleClick: this.clearInput,\n              authBtn: true,\n            },\n          ],\n        },\n      }\n    },\n    mounted(){\n      this.readWorkbookFromRemoteFile('https://wwwswkcom.github.io/yanxitang-data/销售退货表.xls');\n    },\n    methods: {\n      clearInput(){\n        this.getInfoData = {\n          limit: 10,\n          offset: 1,\n          startDelTime: [],\n          startStartTime:'',\n          endStartTime:'',\n        }\n      },\n      readWorkbookFromRemoteFile: function (url) {\n        \n        var xhr = new XMLHttpRequest()\n        xhr.open('get', url, true)\n        xhr.responseType = 'arraybuffer'\n        let _this = this\n        xhr.onload = (e) => {\n          if (xhr.status === 200) {\n            var data = new Uint8Array(xhr.response)\n            \n            const workbook = XLSX.read(data, {\n              type: 'array'\n            })\n            const wsname = workbook.SheetNames[0]// 取第一张表\n            this.alldata= XLSX.utils.sheet_to_json(workbook.Sheets[wsname])// 生成json表格内容\n           console.log(this.alldata);\n          // for(let i = 0 ;i<this.alldata.length;i++){\n          //   this.alldata[i]['往来帐日期'] = this.formatDate(this.alldata[i]['往来帐日期'],'-');\n          // }\n            // this.downloaddata = this.alldata;\n            // this.tabData = this.alldata.slice(0,this.getInfoData.limit)\n            // this.total = this.alldata.length\n            console.log(this.tabData.length);\n\n          }\n          fileReader.readAsBinaryString(files[0])\n        }\n        xhr.send()\n      },\n      gitList(){\n        if(this.getInfoData.startDelTime && this.getInfoData.startDelTime.length > 0){\n          this.getInfoData.startStartTime = this.getInfoData.startDelTime ? this.getInfoData.startDelTime[0] : \"\";\n          this.getInfoData.endStartTime = this.getInfoData.startDelTime ? this.getInfoData.startDelTime[1] : \"\";\n          let searchList = [];\n          // debugger\n        for(let i = 0;i<this.alldata.length;i++){\n          if(this.getInfoData.startStartTime<=this.alldata[i]['往来帐日期'] && this.alldata[i]['往来帐日期'] < this.getInfoData.endStartTime){\n            searchList.push(this.alldata[i])\n          }\n        }\n        this.downloaddata = searchList;\n        this.total = searchList.length\n        this.tabData = searchList.slice((this.getInfoData.offset-1)*this.getInfoData.limit,this.getInfoData.offset*this.getInfoData.limit)\n        }else{\n          this.downloaddata = [];\n          this.total = 0\n          this.tabData = []\n        }\n        // \n        \n      },\n      formatDate(numb, format) {\n        const old = numb - 1;\n        const t = Math.round((old - Math.floor(old)) * 24 * 60 * 60);\n        const time = new Date(1900, 0, old, 0, 0, t)\n        const year = time.getFullYear() ;\n        const month = time.getMonth() + 1 ;\n        const date = time.getDate() ;\n        return year + format + (month < 10 ? '0' + month : month) + format + (date < 10 ? '0' + date : date)\n      },\n    }\n  }\n</script>\n<style scoped>\n.export-excel-wrapper{\n  margin-bottom: 10px;\n}\n</style>\n"]}]}